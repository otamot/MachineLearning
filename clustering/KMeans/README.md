# k-means
## 1. Introduction
### 1.1 クラスタリングとは?
* クラスタリング(clustering)
  - データの集合を”似たもの同士”でグループ化する作業。
* クラスタ(cluster)
  - クラスタリングの結果できあがったグループ。
* 教師なしなので、あらかじめどんなクラスタにクラスタリングされるかはわからない。(こういった規則でわけたいと予め意図があってグループ化するものは"分類"という。clustering≠分類)


### 1.2 k-meansとは?
* ベクトルをk個のクラスタにクラスタリングする手法


## 2. アルゴリズム
### 2.1 k-meansアルゴリズム
```
Step0: 各ベクトルの所属クラスタを乱数で選ぶ。
Step1: 各クラスタに所属するベクトルの重心をとり、クラスタの重心ベクトルとする。
Steo2: 各ベクトルから一番近いクラスタの重心ベクトルを新たな所属クラスタとする。
Step3:	所属クラスタが更新されていればStep1へ、更新されていなければ終了
```


## 3. k-meansの初期値選択
### 3.1 初期点に対する問題
![figure1](figure1.png)

上の図ようなベクトル群をk=2でクラスタリングしたいとする。

![figure2](figure2.png)

理想的にはこのようにクラスタリングされて欲しいという願望がある。

![figure3](figure3.png)

しかし、初期点の取り方によってはこの図のようにクラスタリングされてしまうことがある。

実際にプログラムによって何回か実行すると以下の2パターンのクラスタリングパターンになる。

[pattern1]
```
// クラスタ番号: vectorの要素
0:   0   0
0:   0   1
0:   1   0
0:   1   1
1:   9   0
1:   9   1
1:  10   0
1:  10   1

// クラスタ番号: 重心ベクトル
 0   0.5   0.5
 1   9.5   0.5
```

[pattern2]
```
// クラスタ番号: vectorの要素
1:   0   0
0:   0   1
1:   1   0
0:   1   1
1:   9   0
0:   9   1
1:  10   0
0:  10   1

// クラスタ番号: 重心ベクトル
 0   5.0   1.0
 1   5.0   0.0
```

この問題に対応する初期点の取り方のアルゴリズムがk-means++法である。

### 3.2 k-means++法
k-meansでは初期クラスタをランダムに選ぶため、実行毎に答えが変わり、最適でないことがしばしばある。

これを少しでも解決しようとする初期値選択アルゴリズムのがk-means++である。

k-means++を使うことによって、初期値選択には時間がかかるが、その後の収束スピードがおよそ2倍、データセットによっては誤差が1000分の1まで減り、一連のデータセットでは誤差が減っている。

#### 3.2.1 k-means++法アルゴリズム



```
2:  80  85 100
2:  96 100 100
0:  54  83  98
2:  80  98  98
2:  90  92  91
1:  84  78  82
2:  79 100  96
2:  88  92  92
1:  98  73  72
2:  75  84  85
2:  92 100  96
2:  96  92  90
1:  99  76  91
2:  75  82  88
2:  90  94  94
0:  54  84  87
1:  92  89  62
2:  88  94  97
0:  42  99  80
0:  70  98  70
1:  94  78  83
0:  52  73  87
1:  94  88  72
1:  70  73  80
2:  95  84  90
2:  95  88  84
2:  75  97  89
0:  49  81  86
1:  83  72  80
1:  75  73  88
1:  79  82  76
1: 100  77  89
1:  88  63  79
1: 100  50  86
0:  55  96  84
1:  92  74  77
1:  97  50  73


 0  53.7  87.7  84.6
 1  89.7  73.1  79.3
 2  86.3  92.1  92.7
 ```

## 4. ソースコード
* [KMeans.java](../../src/clustering/KMeans.java)
* [KMeansMain.java](../../src/clustering/KMeansMain.java)

## 5. javadoc
[javadoc](https://htmlpreview.github.io/?https://raw.githubusercontent.com/otamot/MachineLearning/master/doc/clustering/KMeans.html)
html形式のjavadoc。クラスや、メソッドの詳細な説明を記述。



## 参考
* [k-means++法 - Wikipedia](https://ja.wikipedia.org/wiki/K-means%2B%2B%E6%B3%95)
* [k-means++｜ぽんのブログ - アメーバブログ](http://ameblo.jp/p630/entry-10923640201.html)
* [クラスタリングの定番アルゴリズム「K-means法」をビジュアライズしてみた](http://tech.nitoyon.com/ja/blog/2009/04/09/kmeans-visualise/)
* [scikit-learn による最も基本的なクラスタリング分析 - Qiita](http://qiita.com/ynakayama/items/1223b6844a1a044e2e3b)
* [言語処理のための機械学習入門 (自然言語処理シリーズ)](https://www.amazon.co.jp/%E8%A8%80%E8%AA%9E%E5%87%A6%E7%90%86%E3%81%AE%E3%81%9F%E3%82%81%E3%81%AE%E6%A9%9F%E6%A2%B0%E5%AD%A6%E7%BF%92%E5%85%A5%E9%96%80-%E8%87%AA%E7%84%B6%E8%A8%80%E8%AA%9E%E5%87%A6%E7%90%86%E3%82%B7%E3%83%AA%E3%83%BC%E3%82%BA-%E9%AB%98%E6%9D%91-%E5%A4%A7%E4%B9%9F/dp/4339027510)
